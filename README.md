# Puzzler 2023

This year the idea was to do something with the programming language "Basic".

I chose to write a compiler that would compile Basic programs (e.g. from http://www.vintage-basic.net/games.html)
to Java byte code.  To do this I am using the [ASM](https://asm.ow2.io/) library.

The parser is a classic hand-rolled recursive descent parser that generates an
"abstract syntax tree" (AST).  Then a visitor can be used to walk that tree.  Two
visitors are implemented:

* One that just prints the tree
* One that uses the ASM library to generated byte code

Theoretically it could be possible to have other visitors to generate
other kinds of output.

## Notes and limitations

* GOSUB is not implemented using the JSR and RET instructions. It seems those are no longer 
  used by the Java Compiler. It does not seem easy (possible?) to use them in the Java ASM library
  without a lot of work (messing with stack frames etc). So instead a fake approach is used
  whe all GOSUBs are tracked and we push an int onto the stack which the RETURN statements use 
  with a lookup switch instruction to jump back to the correct line.  For small numbers of GOSUB
  statements this should be pretty quick/small, but as the number of GOSUBs increase we will be generating
  more and more code for the RETURN.
* Pairing of FOR + NEXT is done statically at compile time